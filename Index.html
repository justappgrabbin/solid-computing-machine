
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code Universe ‚Äì self-hosting GNN + Later-Queue</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:#0a0a0a;color:#fff;overflow:hidden}
    canvas{position:fixed;top:0;left:0;width:100%;height:100%}

    /* ---- CONTROL PANEL (top-right) ---- */
    .control-panel{position:fixed;top:20px;right:20px;background:rgba(20,20,20,.95);padding:20px;border-radius:10px;border:1px solid #333;z-index:1000;width:300px}
    .control-panel h2{margin-bottom:15px;color:#0f8}
    .upload-area{border:2px dashed #0f8;padding:20px;text-align:center;cursor:pointer;transition:all .3s;margin-bottom:15px}
    .upload-area:hover{background:rgba(0,255,136,.1)}
    .upload-area.dragover{background:rgba(0,255,136,.2);border-color:#0fa}
    textarea{width:100%;height:150px;background:#111;color:#0f8;border:1px solid #333;padding:10px;font-family:Courier New,monospace;font-size:12px;margin-bottom:15px;resize:vertical}
    button{background:#0f8;color:#000;border:none;padding:10px 20px;cursor:pointer;font-weight:bold;transition:all .3s;width:100%}
    button:hover{background:#0fa;transform:scale(1.05)}
    .info{margin-top:15px;font-size:12px;color:#888}
    .node-label{position:absolute;background:#000c;padding:5px 10px;border-radius:5px;font-size:12px;pointer-events:none;z-index:100;border:1px solid #0f8}

    /* ---- TENDER PANEL ---- */
    .tender-panel{position:fixed;bottom:20px;left:20px;width:350px;max-height:400px;background:rgba(10,10,10,.95);border:1px solid #0f8;border-radius:10px;padding:15px;overflow-y:auto;display:none;z-index:1001}
    .tender-message{margin-bottom:10px;padding:8px 12px;border-radius:6px;font-size:14px}
    .tender-message.ai{background:#0f82;color:#0f8}
    .tender-message.user{background:#06f2;color:#66ccff;text-align:right}
    textarea#userIntent{width:100%;height:60px;font-size:13px;margin-top:10px;resize:none}
    button#sendIntentBtn{margin-top:5px;background:#06f;color:#fff}
    button#shareBtn{background:#fc0;color:#000}

    /* ---- LATER-QUEUE PANEL ---- */
    #laterPanel{position:fixed;bottom:80px;right:20px;width:220px;max-height:300px;background:rgba(10,10,10,.95);border:1px solid #f92;border-radius:8px;padding:10px;display:none;z-index:1003}
    #laterPanel>div:first-child{color:#f92;font-size:12px;margin-bottom:6px}
    #laterList{font-size:11px;max-height:240px;overflow-y:auto}
    #clearLaterBtn{margin-top:6px;width:100%;font-size:10px;background:#444;color:#fff}
    .later-item{padding:4px 6px;margin:2px 0;background:#221a00;border-left:2px solid #f92;font-family:monospace;cursor:pointer;font-size:10px}
    .later-item:hover{background:#332200}

    /* ---- FLOATING BUTTONS ---- */
    .toggle-tender{position:fixed;bottom:20px;right:20px;width:50px;height:50px;border-radius:50%;background:#0f8;color:#000;border:none;font-size:20px;cursor:pointer;z-index:1002}
    #toggleLaterBtn{position:fixed;bottom:120px;right:20px;width:40px;height:40px;border-radius:50%;background:#f92;color:#000;border:none;display:none;cursor:pointer;z-index:1002}
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>

  <!-- CONTROL PANEL -->
  <div class="control-panel">
    <h2>Code Universe</h2>
    <div class="upload-area" id="uploadArea"><p>üìÅ Drop files / click to upload</p><input type="file" id="fileInput" multiple style="display:none"></div>
    <textarea id="codeInput" placeholder="‚Ä¶or paste code here"></textarea>
    <button id="processBtn">üöÄ Process Code</button>
    <div class="info"><p>‚Ä¢ Drag to rotate  ‚Ä¢ Scroll zoom  ‚Ä¢ Click node expand</p></div>
  </div>

  <!-- TENDER -->
  <button class="toggle-tender" id="toggleTenderBtn">üí°</button>
  <div class="tender-panel" id="tenderPanel">
    <h3 style="color:#0f8;margin-bottom:10px">Code Tender üå±</h3>
    <div id="tenderChat"></div>
    <textarea id="userIntent" placeholder="Tell me what you were trying to build‚Ä¶"></textarea>
    <button id="sendIntentBtn">Send</button>
    <button id="shareBtn">Share Codebase + Ideas</button>
  </div>

  <!-- LATER QUEUE -->
  <button id="toggleLaterBtn">‚ôª</button>
  <div id="laterPanel">
    <div>üìÇ LATER FILES</div>
    <div id="laterList"></div>
    <button id="clearLaterBtn">clear</button>
  </div>

  <script>
    /* ---------- BASIC SETUP ---------- */
    const canvas=document.getElementById('canvas'),ctx=canvas.getContext('2d');
    let W=canvas.width=innerWidth, H=canvas.height=innerHeight;
    addEventListener('resize',()=>{W=canvas.width=innerWidth;H=canvas.height=innerHeight});

    /* ---------- GNN CORE ---------- */
    class Node{
      constructor(id,label,type,content=''){
        this.id=id;this.label=label;this.type=type;this.content=content;
        this.x=Math.random()*W;this.y=Math.random()*H;this.z=Math.random()*500;
        this.vx=0;this.vy=0;this.vz=0;
        this.radius=Math.max(20,Math.min(60,content.length/10));
        this.color=colorOf(type);
        this.level=0;this.expanded=false;this.children=[];
      }
      update(){
        this.vx*=.95;this.vy*=.95;this.vz*=.95;
        this.x+=this.vx;this.y+=this.vy;this.z+=this.vz;
        const cx=W/2,cy=H/2;
        this.vx+=(cx-this.x)*.001;this.vy+=(cy-this.y)*.001;
      }
      draw(){
        const p=500/(500+this.z),sx=this.x+(this.x-W/2)*(1-p),sy=this.y+(this.y-H/2)*(1-p),r=this.radius*p;
        const g=ctx.createRadialGradient(sx-r/3,sy-r/3,0,sx,sy,r);
        g.addColorStop(0,this.color+'ff');g.addColorStop(1,this.color+'66');
        ctx.beginPath();ctx.arc(sx,sy,r,0,Math.PI*2);ctx.fillStyle=g;ctx.fill();
        ctx.strokeStyle=this.color;ctx.lineWidth=2;ctx.stroke();
        ctx.fillStyle='#000';ctx.font=(12*p)+'px Arial';ctx.textAlign='center';ctx.textBaseline='middle';
        ctx.fillText(this.label,sx,sy);
      }
    }
    function colorOf(t){
      const map={function:'#0f8',class:'#f66',variable:'#4ec',import:'#fe6',comment:'#9e1',file:'#ae6',method:'#f8a',later:'#f92',default:'#8d8'};
      return map[t]||map.default;
    }

    class Graph{
      constructor(){this.nodes=[];this.edges=[];this.selected=null;this.mx=0;this.my=0;this.rotX=0;this.rotY=0;this.zoom=1}
      addNode(l,t,c){const n=new Node(this.nodes.length,l,t,c);this.nodes.push(n);return n}
      addEdge(a,b){this.edges.push({from:a,to:b})}
      update(){this.nodes.forEach(n=>n.update())}
      draw(){
        ctx.save();
        ctx.translate(W/2,H/2);ctx.scale(this.zoom,this.zoom);ctx.translate(-W/2,-H/2);
        this.edges.forEach(e=>{
          const p=500/(500+e.from.z),p2=500/(500+e.to.z);
          ctx.beginPath();ctx.moveTo(e.from.x+(e.from.x-W/2)*(1-p),e.from.y+(e.from.y-H/2)*(1-p));
      
